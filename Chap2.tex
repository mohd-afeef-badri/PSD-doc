\chapter{Installation}


PSD is cross-platform solver built to work with Linux, MacOs, and Windows platforms. 

\section{Dependencies}

To install and work with PSD first check that you have installed all the dependencies. PSD depends on the following:   

\begin{itemize}
\item  {\ttfamily C++}    (g++ version 4.8 or greater) (or Intel compiler)
\item  {\ttfamily automake}
\item  {\ttfamily FreeFEM}
\item  {\ttfamily PETSc}      (optional)
\item  {\ttfamily Gmsh}
\item  {\ttfamily gnuplot}	(optional)
\item  {\ttfamily git}   
\end{itemize}


\section{PSD installation steps \label{sec:psd-install}}
Now that I have all the dependencies what next ?  

\begin{itemize}
\item  Go ahead and grab the latest copy of PSD. The code is hosted on CEA's internal git repository.

\begin{lstlisting}[style=Linux]
git clone https://codev-tuleap.intra.cea.fr/plugins/git/hpcseism/freefem.git  PSD-Sources
\end{lstlisting}

\item  Now goto the \lstinline[style=Linux]! PSD-Sources! folder and autoconf PSD within the  cloned folder

\begin{lstlisting}[style=Linux]
autoreconf -i
\end{lstlisting}

\item Configure  PSD within the  cloned folder
\begin{lstlisting}[style=Linux]
./configure
\end{lstlisting}
\textbf{Note}:  \lstinline[style=Linux]!./configure! will install PSD in \lstinline[style=Linux]!/usr/local/bin! and you would need sudo rights to perform installation, for non sudo users or for local install consider chaning directory of installation. To change this directory use \lstinline[style=Linux]!--prefix=Your/Own/Path! with \lstinline[style=Linux]!./configure!. Remember to add \lstinline[style=Linux]!Your/Own/Path! to your  \lstinline[style=Linux]!PATH! variable, you can do so by \lstinline[style=Linux]! export PATH=$PATH:Your/Own/Path!

\textbf{Note}:   \lstinline[style=Linux]! ./configure! will try to look for installation of \lstinline[style=Linux]! FreeFEM! and \lstinline[style=Linux]! Gmsh! in \lstinline[style=Linux]! usr/bin/! or \lstinline[style=Linux]! usr/local/bin/! directories. If you have these packages installed in some other directory this should be specified during \lstinline[style=Linux]! ./configure! by using flags \lstinline[style=Linux]! --with-FreeFEM=! and \lstinline[style=Linux]! --with-Gmsh=!. For example, if \lstinline[style=Linux]! FreeFEM! is installed at \lstinline[style=Linux]! home/FreeFem/bin! and \lstinline[style=Linux]! Gmsh! in \lstinline[style=Linux]!home/Gmsh/bin! then one should use

\textbf{Note}: Please use the new version of \lstinline[style=Linux]!Gmsh! (greater than version 4.3.0) from their official website.

\begin{lstlisting}[style=Linux]
./configure --with-FreeFEM=home/FreeFem/bin  --with-Gmsh=home/Gmsh/bin
\end{lstlisting}

\item Make PSD directives
\begin{lstlisting}[style=Linux]
make 
\end{lstlisting}


\item Install PSD
\begin{lstlisting}[style=Linux]
sudo make install
\end{lstlisting}

\textbf{Note} : You should not use \lstinline[style=Linux]! sudo! if you have used \lstinline[style=Linux]!--prefix! during the \lstinline[style=Linux]! ./configure! simply use

\begin{lstlisting}[style=Linux]
make install
\end{lstlisting} 
 


\textbf{Note:} To install a copy of PSD for developers use the following instead of\lstinline[style=Linux]! sudo make install!  

\begin{lstlisting}[style=Linux]
make install-devel
\end{lstlisting}


\end{itemize}

Now you should have the PSD solver installed in your machine. Note that, the solver will be installed at \lstinline[style=Linux]! usr/bin ! or \lstinline[style=Linux]! usr/local/bin ! directories if you used \lstinline[style=Linux]! sudo make install ! or else it will be in your \lstinline[style=Linux]! --prefix ! location.  


\textbf{\large Additional steps (optional)}
\begin{itemize}

\item Check if installation is correct 
\begin{lstlisting}[style=Linux]
make check
\end{lstlisting}

\item Install PSD tutorials

\begin{lstlisting}[style=Linux]
make tutorials
\end{lstlisting}

PSD tutorials will be installed in you \lstinline[style=Linux]!  home ! directory in a folder \lstinline[style=Linux]!  ${HOME}/PSD-tutorials !  

\end{itemize}

\section{Update PSD to the latest version}

If you are a PSD user and would like to update your old PSD source to a new one. Go to your \lstinline[style=Linux]! PSD-Sources! folder and

\begin{lstlisting}[style=Linux]
git pull origin master
\end{lstlisting}

After this step simply

\begin{lstlisting}[style=Linux]
./reconfigure;  make;  make install;  make check
\end{lstlisting}

\section{PSD developers version}

If you would like to install  a developers copy  of PSD use:

\begin{lstlisting}[style=Linux]
make install-devel;
\end{lstlisting}
